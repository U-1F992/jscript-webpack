globalThis.document = WScript.CreateObject("htmlfile");
globalThis.window = (document as Document & { parentWindow: typeof window }).parentWindow;

const methods = [
    "setTimeout",
    "clearTimeout",
    "setInterval",
    "clearInterval",
    "setImmediate",
    "clearImmediate",
]
methods.forEach(method => {
    // Function#apply cannot be used for methods of COM objects
    // Arguments seems not to be passed to the callback
    globalThis[method] = function () {
        return window[method](arguments[0], arguments[1], arguments[2], arguments[3], arguments[4], arguments[5], arguments[6], arguments[7], arguments[8], arguments[9], arguments[10], arguments[11], arguments[12], arguments[13], arguments[14], arguments[15], arguments[16], arguments[17], arguments[18], arguments[19], arguments[20], arguments[21], arguments[22], arguments[23], arguments[24], arguments[25], arguments[26], arguments[27], arguments[28], arguments[29], arguments[30], arguments[31], arguments[32], arguments[33], arguments[34], arguments[35], arguments[36], arguments[37], arguments[38], arguments[39], arguments[40], arguments[41], arguments[42], arguments[43], arguments[44], arguments[45], arguments[46], arguments[47], arguments[48], arguments[49], arguments[50], arguments[51], arguments[52], arguments[53], arguments[54], arguments[55], arguments[56], arguments[57], arguments[58], arguments[59], arguments[60], arguments[61], arguments[62], arguments[63], arguments[64], arguments[65], arguments[66], arguments[67], arguments[68], arguments[69], arguments[70], arguments[71], arguments[72], arguments[73], arguments[74], arguments[75], arguments[76], arguments[77], arguments[78], arguments[79], arguments[80], arguments[81], arguments[82], arguments[83], arguments[84], arguments[85], arguments[86], arguments[87], arguments[88], arguments[89], arguments[90], arguments[91], arguments[92], arguments[93], arguments[94], arguments[95], arguments[96], arguments[97], arguments[98], arguments[99], arguments[100], arguments[101], arguments[102], arguments[103], arguments[104], arguments[105], arguments[106], arguments[107], arguments[108], arguments[109], arguments[110], arguments[111], arguments[112], arguments[113], arguments[114], arguments[115], arguments[116], arguments[117], arguments[118], arguments[119], arguments[120], arguments[121], arguments[122], arguments[123], arguments[124], arguments[125], arguments[126], arguments[127], arguments[128], arguments[129], arguments[130], arguments[131], arguments[132], arguments[133], arguments[134], arguments[135], arguments[136], arguments[137], arguments[138], arguments[139], arguments[140], arguments[141], arguments[142], arguments[143], arguments[144], arguments[145], arguments[146], arguments[147], arguments[148], arguments[149], arguments[150], arguments[151], arguments[152], arguments[153], arguments[154], arguments[155], arguments[156], arguments[157], arguments[158], arguments[159], arguments[160], arguments[161], arguments[162], arguments[163], arguments[164], arguments[165], arguments[166], arguments[167], arguments[168], arguments[169], arguments[170], arguments[171], arguments[172], arguments[173], arguments[174], arguments[175], arguments[176], arguments[177], arguments[178], arguments[179], arguments[180], arguments[181], arguments[182], arguments[183], arguments[184], arguments[185], arguments[186], arguments[187], arguments[188], arguments[189], arguments[190], arguments[191], arguments[192], arguments[193], arguments[194], arguments[195], arguments[196], arguments[197], arguments[198], arguments[199], arguments[200], arguments[201], arguments[202], arguments[203], arguments[204], arguments[205], arguments[206], arguments[207], arguments[208], arguments[209], arguments[210], arguments[211], arguments[212], arguments[213], arguments[214], arguments[215], arguments[216], arguments[217], arguments[218], arguments[219], arguments[220], arguments[221], arguments[222], arguments[223], arguments[224], arguments[225], arguments[226], arguments[227], arguments[228], arguments[229], arguments[230], arguments[231], arguments[232], arguments[233], arguments[234], arguments[235], arguments[236], arguments[237], arguments[238], arguments[239], arguments[240], arguments[241], arguments[242], arguments[243], arguments[244], arguments[245], arguments[246], arguments[247], arguments[248], arguments[249], arguments[250], arguments[251], arguments[252], arguments[253], arguments[254], arguments[255]);
    };
});
